<html>
<head>
	<meta http-equiv=Content-Type content="text/html; charset=us-ascii">
	<meta name=Generator content="Microsoft Word 14 (filtered)">
	<title>&#55092; &#44032; &#49888; &#52397; &#49436;</title>
	<style>
		@media print {@page {margin: 0;} body {margin: 1.6cm;}}
		@font-face {font-family:Batang; panose-1:2 3 6 0 0 1 1 1 1 1;}
		@font-face {font-family:Gulim; panose-1:2 11 6 0 0 1 1 1 1 1;}
		@font-face {font-family:"Cambria Math"; panose-1:2 4 5 3 5 4 6 3 2 4;}
		@font-face {font-family:"Malgun Gothic"; panose-1:2 11 5 3 2 0 0 2 0 4;}
		@font-face {font-family:"Malgun Gothic"; panose-1:2 11 5 3 2 0 0 2 0 4;}
		@font-face {font-family:Gulim; panose-1:2 11 6 0 0 1 1 1 1 1;}
		@font-face {font-family:Batang; panose-1:2 3 6 0 0 1 1 1 1 1;}
		p.MsoNormal, li.MsoNormal, div.MsoNormal {margin:0cm; margin-bottom:.0001pt; text-align:justify; text-justify:inter-ideograph; text-autospace:none; word-break:break-hangul; font-size:10.0pt; font-family:"Times New Roman","serif";}
		h1 {mso-style-link:"\C81C\BAA9 1 Char"; margin:0cm; margin-bottom:.0001pt; text-align:center; page-break-after:avoid; text-autospace:none; word-break:break-hangul; font-size:18.0pt; font-family:Gulim;}
		h2 {mso-style-link:"\C81C\BAA9 2 Char"; margin:0cm; margin-bottom:.0001pt; text-align:center; page-break-after:avoid; text-autospace:none; word-break:break-hangul; font-size:13.0pt; font-family:Gulim;}
		h3 {mso-style-link:"\C81C\BAA9 3 Char"; margin-top:0cm; margin-right:0cm; margin-bottom:0cm; margin-left:15.0pt; margin-bottom:.0001pt; text-align:justify; text-justify:inter-ideograph; text-indent:-100.0pt; page-break-after:avoid; text-autospace:none; word-break:break-hangul; font-size:11.0pt; font-family:Gulim; font-weight:normal;}
		p.MsoHeader, li.MsoHeader, div.MsoHeader {mso-style-link:"\BA38\B9AC\AE00 Char"; margin:0cm; margin-bottom:.0001pt; text-align:justify; text-justify:inter-ideograph; layout-grid-mode:char; text-autospace:none; word-break:break-hangul; font-size:10.0pt; font-family:"Times New Roman","serif";}
		p.MsoFooter, li.MsoFooter, div.MsoFooter {mso-style-link:"\BC14\B2E5\AE00 Char"; margin:0cm; margin-bottom:.0001pt; text-align:justify; text-justify:inter-ideograph; layout-grid-mode:char; text-autospace:none; word-break:break-hangul; font-size:10.0pt; font-family:"Times New Roman","serif";}
		span.1Char {mso-style-name:"\C81C\BAA9 1 Char"; mso-style-link:"\C81C\BAA9 1"; font-family:"Malgun Gothic";}
		span.2Char {mso-style-name:"\C81C\BAA9 2 Char"; mso-style-link:"\C81C\BAA9 2"; font-family:"Malgun Gothic";}
		span.3Char {mso-style-name:"\C81C\BAA9 3 Char"; mso-style-link:"\C81C\BAA9 3"; font-family:"Malgun Gothic";}
		span.Char {mso-style-name:"\BA38\B9AC\AE00 Char"; mso-style-link:\BA38\B9AC\AE00; font-family:"??","serif";}
		span.Char0 {mso-style-name:"\BC14\B2E5\AE00 Char"; mso-style-link:\BC14\B2E5\AE00; font-family:"??","serif";}
		p.a, li.a, div.a {mso-style-name:\BC14\D0D5\AE00; margin:0cm; margin-bottom:.0001pt; text-align:justify; text-justify:inter-ideograph; line-height:122%; text-autospace:none; word-break:break-hangul; font-size:10.0pt; font-family:"Times New Roman","serif"; color:black;}
		p.a0, li.a0, div.a0 {mso-style-name:\BE44\C988\D3FC; margin:0cm; margin-bottom:.0001pt; text-align:justify; text-justify:inter-ideograph; line-height:122%; text-autospace:none; word-break:break-hangul; font-size:11.0pt; font-family:"Times New Roman","serif"; color:black;}
		@page WordSection1 {size:595.3pt 841.9pt; margin:70.85pt 51.0pt 70.85pt 51.0pt;}
		div.WordSection1 {page:WordSection1;}
		.ui-dialog-buttonset button:first-child {border: 1px solid #0000ff; color: #0000ff; border-radius:20px; font-size:14px;}
		.ui-dialog-buttonset button:last-child  {border: 1px solid #ff0000; color: #ff0000; border-radius:20px; font-size:14px;}
		#dialogProcessing form textarea {width:460px; height:146px; resize:none;}
	</style>
</head>
<body lang="KO" style="width:656px; text-justify-trim:punctuation;padding-left:15px;">

	<!-- 인쇄 버튼 -->
	<c:if test="${param.type eq 'stored'}">
		<div class="noprint" style="position:absolute; left:590px; top:7px;">
			<button type="button" onclick="javascript:window.print();" class="btn btn-default">인쇄</button>
		</div>
		
		<script>
		$(document).ready(function() {
		    var beforePrint = function() {
		    	$(".noprint").hide();
		    };
	
		    var afterPrint = function() {
		    	$(".noprint").show();
		    };
	
		    if(window.matchMedia) {
		        var mediaQueryList = window.matchMedia("print");
		        mediaQueryList.addListener(function(mql) {
		            if (mql.matches) {
		                beforePrint();
		            } else {
		                afterPrint();
		            }
		        });
		    }
	
		    window.onbeforeprint = beforePrint;
		    window.onafterprint = afterPrint;
		});
		</script>
	</c:if>
	
	<c:if test="${!empty consultationApprovalInfo.uploadNo}">
		<c:set var="left" value="465"/>
		<c:if test="${param.type eq 'received'}">
			<c:set var="left" value="465"/>
		</c:if>
		<div style="position:absolute; left:${left}px; top:7px;">
			<button type="button" id="btnDownload" class="btn btn-default">첨부다운로드</button>
		</div>
		<script>
		$(document).ready(function() {
			$("#btnDownload").click(function() {
				window.open("${ctx}/file/download?no=${consultationInfo.uploadNo}", "_blank");
			});
			
		    var beforePrint = function() {
		    	$("#btnDownload").hide();
		    	$("#btnProcessing").hide();
		    };

		    var afterPrint = function() {
		    	$("#btnDownload").show();
		    	$("#btnProcessing").show();
		    };

		    if(window.matchMedia) {
		        var mediaQueryList = window.matchMedia("print");
		        mediaQueryList.addListener(function(mql) {
		            if (mql.matches) {
		                beforePrint();
		            } else {
		                afterPrint();
		            }
		        });
		    }

		    window.onbeforeprint = beforePrint;
		    window.onafterprint = afterPrint;
		});
		</script>
	</c:if>
	<c:if test="${param.type eq 'received'}">
		<div style="position:absolute; left:590px; top:7px;">
			<button type="button" id="btnProcessing" class="btn btn-default">처리</button>
		</div>
		<div id="dialogProcessing" title="결재승인 하시겠습니까?" style="display:none;">
			<form id="frm">
				<input type="hidden" name="aprvLnkgClsf" value="consultation"/>
				<input type="hidden" name="cstnNo" value="${consultationApprovalInfo.cstnNo}"/>
				<input type="hidden" name="aprvNo" value="${consultationApprovalInfo.aprvNo}"/>
				<input type="hidden" name="dcofNo" id="dcofNo"/>
				<input type="hidden" name="docfStat" id="docfStat"/>
				<textarea name="aprvRmrk" style="margin: 0px; height: 150px; width: 250px;"></textarea>
			</form>
		</div>
		<script>
		$(document).ready(function() {
			$("#dialogProcessing").dialog({
				autoOpen: false,
				width: 300,
				height: 300,
				modal: true,
				resizable: false,
				buttons: [{
					text: "승인",
					click: function() {
	    				updateApprovalOrReject("DS02");
					}
				},{
					text: "반려",
					click: function() {
						updateApprovalOrReject("DS03");
					}
	   			}]
			});
	
			$("#btnProcessing").click(function() {
				$("#dialogProcessing").dialog("open");
			});
		});
	
		function updateApprovalOrReject(docfStat) {
			$("#docfStat").val(docfStat);
			$("#dialogProcessing").dialog("close");
			$.ajax({
				url: "./updateApprovalOrRejectJson",
				type: "post",
				data: $("#frm").serialize(),
				success: function(obj) {
					alert("처리되었습니다.");
					opener.location.reload();
					window.close();
				},
				error: function(e) {
					alert("오류가 발생하였습니다");
				}
			});
		}
		</script>
	</c:if>
	<script>
	function fnDecidingOfficerShowName(index, name) {
		$("#decidingOfficer" + index).text(name);
	}
	</script>
	
	<div class="WordSection1">
		<table cellpadding="0" cellspacing="0" align="left">
			<tr><td width="0" height="1"></td></tr>
			<tr><td></td><td><img width="105" height="50" src="/nos.mm/img/logo.jpg"></td></tr>
		</table>
		<span lang=EN-US>&nbsp;</span>
		<br clear="ALL"/>
		<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 style='margin-left:2.0pt;border-collapse:collapse;border:none'>
			<tr style='height:42.2pt'>
				<td width=652 style='width:488.95pt;border:none;padding:0cm .6pt 0cm .6pt; height:42.2pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'>
						<b><span style='font-size:28.0pt;line-height:122%;font-family:Gulim'>품 의 신 청 서</span></b>
  					</p>
				</td>
			</tr>
		</table>

		<p class=a><span style='font-size:1.0pt;line-height:122%;font-family:Gulim; color:white'></span></p>
		<p class=a0 align=center style='text-align:center;word-break:keep-all'><span lang=EN-US style='font-size:1.0pt;line-height:122%;font-family:Gulim'>&nbsp;</span></p>
		<p class=a0><span lang=EN-US style='font-family:Gulim'>&nbsp;</span></p>
		<p class=a0><span lang=EN-US style='font-family:Gulim'>&nbsp;</span></p>

		<c:set var="decidingOfficerCnt" value="${fn:length(decidingOfficerList)}"/>
		<div style="width:641px; overflow:hidden;">
			<div style="float:right;">
				<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 style='margin-left:2.15pt;border-collapse:collapse;border:none'>
					<tr style='page-break-inside:avoid;height:24.15pt'>
						<td width=53 colspan=2 rowspan=2 style='width:39.85pt;border-top:solid windowtext 1.5pt; border-left:solid windowtext 1.5pt; border-bottom:none; border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:24.15pt'>
							<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>결</span></p>
							<p class=a0 align=center style='text-align:center;word-break:keep-all'>&nbsp;</p>
							<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>재</span></p>
						</td>
						<td width=80 colspan=2 style='width:54.2pt;border-top:solid windowtext 1.5pt; border-left:none; border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:24.15pt'>
							<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>담 당</span></p>
						</td>

						<c:forEach var="decidingOfficerInfo" items="${decidingOfficerList}" varStatus="status">
							<c:if test="${decidingOfficerInfo.memNo eq sesMemNo}">
								<script>
								$(document).ready(function() {
									$("#dcofNo").val("${decidingOfficerInfo.dcofNo}");
								});
								</script>
							</c:if>
							<c:set var="borderRight" value="solid windowtext 1.0pt"/>
							<c:if test="${decidingOfficerCnt eq status.count}">
								<c:set var="borderRight" value="solid windowtext 1.5pt"/>
							</c:if>
							<td width=80 style='width:60.85pt;border-top:solid windowtext 1.5pt; border-left:none;border-bottom:solid windowtext 1.0pt;border-right:${borderRight}; padding:0cm .6pt 0cm .6pt;height:24.15pt'>
							<p class=a0 align=center style='text-align:center;word-break:keep-all'>
								<span style='font-family:Gulim'>${fn:substring(decidingOfficerInfo.memGradeNm, 0, 1)}&nbsp;${fn:substring(decidingOfficerInfo.memGradeNm, 1, 2)}</span>
							</p>
						</td>
						</c:forEach>
					</tr>
					<tr style='page-break-inside:avoid;height:46.1pt'>
						<td width=80 colspan=2 style='width:54.2pt;border-top:none;border-left:none; border-bottom:none; border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:46.1pt'>
							<p class=a0 align=center style='text-align:center;word-break:keep-all' id="decidingOfficer0">
								<img src="/nos.mm/download/${consultationApprovalInfo.signImg}" onerror="fnDecidingOfficerShowName(0, '${consultationApprovalInfo.memName}')" style="width:70px; height:60px;"/>
							</p>
						</td>
						<c:forEach var="decidingOfficerInfo" items="${decidingOfficerList}" varStatus="status">
							<c:set var="borderRight" value="solid windowtext 1.0pt"/>
							<c:if test="${decidingOfficerCnt eq status.count}">
								<c:set var="borderRight" value="solid windowtext 1.5pt"/>
							</c:if>
							<td width=80 style='width:60.85pt;border-top:none;border-left:none; border-bottom:none; border-right:${borderRight}; padding:0cm .6pt 0cm .6pt;height:46.1pt; text-align:center;'>
								<c:if test="${decidingOfficerInfo.docfStat eq 'DS02'}">
									<p class=a0 align=center style='text-align:center;word-break:keep-all' id="decidingOfficer${status.count}">
										<img src="/nos.mm/download/${decidingOfficerInfo.signImg}" style="width:70px; height:60px;" onerror="fnDecidingOfficerShowName(${status.count}, '${decidingOfficerInfo.memName}')"/>
									</p>
								</c:if>
								<c:if test="${decidingOfficerInfo.docfStat eq 'DS03'}">
									<label style="color:red;">반려</label>
								</c:if>
							</td>
						</c:forEach>
					</tr>
				</table>
			</div>
		</div>

		<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 style='margin-left:2.15pt;border-collapse:collapse;border:none'>
			<tr style='height:34.1pt'>
				<td width=126 style='width:94.55pt;border-top:none;border-left:solid windowtext 1.5pt; border-top:solid windowtext 1.5pt; border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>작&nbsp;성&nbsp;일&nbsp;자</span></p>
				</td>
				<td width=253 colspan=2 style='width:189.65pt;border-top:none;border-left: none; border-top:solid windowtext 1.5pt; border-bottom:solid windowtext 1.0pt; border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>${consultationApprovalInfo.wrotDt}</span></p>
				</td>
				<td width=101 colspan=2 style='width:76.1pt;border-top:none;border-left:none; border-top:solid windowtext 1.5pt; border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>시&nbsp;행&nbsp;일&nbsp;자</span></p>
				</td>
				<td width=168 colspan=3 style='width:126.2pt;border-top:none;border-left: none; border-top:solid windowtext 1.5pt; border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>${consultationApprovalInfo.enfcDt}</span></p>
				</td>
			</tr>
			<tr style='height:34.1pt'>
				<td width=126 style='width:94.55pt;border-top:none;border-left:solid windowtext 1.5pt; border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>기&nbsp;안&nbsp;부&nbsp;서</span></p>
				</td>
				<td width=253 colspan=2 style='width:189.65pt;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>${consultationApprovalInfo.memDeptNm}</span></p>
				</td>
				<td width=101 colspan=2 style='width:76.1pt;border-top:none;border-left:none; border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>기&nbsp;&nbsp;안&nbsp;&nbsp;자</span></p>
				</td>
				<td width=168 colspan=3 style='width:126.2pt;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'><span style='font-family:Gulim'>${consultationApprovalInfo.memName}</span></p>
				</td>
			</tr>
			<tr style='height:34.1pt'>
				<td width=126 style='width:94.55pt;border-top:none;border-left:solid windowtext 1.5pt; border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0cm .6pt 0cm .6pt;height:34.1pt'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'>
						<span style='font-family:Gulim'>제&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;목</span>
					</p>
				</td>
				<td width=523 colspan=7 style='width:391.95pt;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt; padding:0cm .6pt 0cm .6pt;height:34.1pt;'>
					<p class=a0 align=center style='text-align:center;word-break:keep-all'>
						<span style='font-family:Gulim'>${consultationApprovalInfo.cstnTitle}</span>
					</p>
				</td>
			</tr>
			<tr style='height:395.35pt'>
				<td id="content_remove" width=649 colspan=10 style='width:486.5pt;border:solid windowtext 1.5pt; border-top:none;padding:0cm .6pt 0cm .6pt;height:300pt;word-break:break-all;' valign="top">
					${consultationApprovalInfo.cstnCn}
				</td>
			</tr>
			<tr height=0>
				<td width=126 style='border:none'></td>
				<td width=239 style='border:none'></td>
				<td width=14 style='border:none'></td>
				<td width=39 style='border:none'></td>
				<td width=62 style='border:none'></td>
				<td width=10 style='border:none'></td>
				<td width=77 style='border:none'></td>
				<td width=81 style='border:none'></td>
			</tr>
		</table>
		<p class=a><span style='font-size:1.0pt;line-height:122%;font-family:Gulim; color:white'></span></p>
		<p class=a0><span lang=EN-US style='font-size:1.0pt;line-height:122%; font-family:Gulim'>&nbsp;</span></p>
		<p class=a0 align=center style='text-align:center;word-break:keep-all;width:100%'><b><span style='font-size:14.0pt;line-height:122%;font-family:Gulim'>나인원소프트주식회사</span></b></p>
	</div>
</body>

<script>
	<!-- 모바일 대응 -->
	var mobileArr = new Array("iPhone", "iPod", "BlackBerry", "Android", "Windows CE", "LG", "MOT", "SAMSUNG", "SonyEricsson");
		for(var txt in mobileArr){
			if(navigator.userAgent.match(mobileArr[txt]) != null){
				$('.WordSection1').css("margin-top","100px");
				$('.WordSection1').css("margin-left","-10px");
				$('.WordSection1').css("margin-right","10px");
				break;
			}
		}
</script>
</html>